# Shakespeare Sonnet++ Postmortem (incident #465)

## Date

2015-10-21

## Authors

* jennifer

## Status

Complete, action items in progress

## Summary

Shakespeare Search down for 66 minutes during period of very high interest in Shakespeare due to discovery of a new sonnet.

## Impact

Estimated 1.21B queries lost, no revenue impact.

## Root Causes

Cascading failure due to combination of exceptionally high load and a resource leak when searches failed due to terms not being in the Shakespeare corpus. The newly discovered sonnet used a word that had never before appeared in one of Shakespeare's works, which happened to be the term users searched for. Under normal circumstances, the rate of task failures due to resource leaks is low enough to be unnoticed.

## Trigger

Latent bug triggered by sudden increase in traffic.

## Resolution

Directed traffic to sacrificial cluster and added 10x capacity to mitigate cascading failure. Updated index deployed, resolving interaction with latent bug. Maintaining extra capacity until surge in public interest in new sonnet passes. Resource leak identified and fix deployed.

## Detection

Borgmon detected high level of HTTP 500s and paged on-call.

## Action Items

| Action Item | Type | Owner | Bug |
| ----------- | ---- | ----- | --- |
| Update playbook with instructions for responding to cascading failure | mitigate | jennifer | n/a **DONE** |

## Lessons Learned

### What went well

* Monitoring quickly alerted us to high rate (reaching ~100%) of HTTP 500s

### What went wrong

* We're out of practice in responding to cascading failure

### Where we got lucky

* Mailing list of Shakespeare aficionados had a copy of new sonnet available

## Timeline

2015-10-21 (*all times UTC*)

| Time  | Description |
| ----- | ----------- |
| 14:51 | News reports that a new Shakespearean sonnet has been discovered in a Delorean's glove compartment |

## Supporting Information

* Monitoring dashboard, <http://monitor/shakespeare?end_time=20151021T160000&duration=7200>
